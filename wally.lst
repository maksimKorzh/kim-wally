;-----------------------------------------------------------------------;
;  Program:     Wally                                                   ;
;  Author:      Code monkey King                                        ;
;  Date:        2024-08-14                                              ;
;  System:      Unexpanded KIM-1                                        ;
;-----------------------------------------------------------------------;
;  Description:                                                         ;
;  This listing is a reconstruction of the original game of Go playing  ;
;  program written by Jonathan K. Millen for the unexpanded KIM-1. The  ;
;  code has been carefully assembled by hand to preserve the original   ;
;  functionality on the same platform.                                  ;
;-----------------------------------------------------------------------;

;-----------------------------------------------------------------------;
;                 BOARD REPRESENTATION & PIECE ENCODING                 ;
;-----------------------------------------------------------------------;
;                                                                       ;
;      00  01  02  03  04  05  06  07  08  09  0A  0B  0C  0D  0E       ;
;      10  11  12  13  14  15  16  17  18  19  1A  1B  1C  1D  1E       ;
;      20  21  22  23  24  25  26  27  28  29  2A  2B  2C  2D  2E       ;
;      30  31  32  33  34  35  36  37  38  39  3A  3B  3C  3D  3E       ;
;      40  41  42  43  44  45  46  47  48  49  4A  4B  4C  4D  4E       ;
;      50  51  52  53  54  55  56  57  58  59  5A  5B  5C  5D  5E       ;
;      60  61  62  63  64  65  66  67  68  69  6A  6B  6C  6D  6E       ;
;      70  71  72  73  74  75  76  77  78  79  7A  7B  7C  7D  7E       ;
;      80  81  82  83  84  85  86  87  88  89  8A  8B  8C  8D  8E       ;
;      90  91  92  93  94  95  96  97  98  99  9A  9B  9C  9D  9E       ;
;      A0  A1  A2  A3  A4  A5  A6  A7  A8  A9  AA  AB  AC  AD  AE       ;
;      B0  B1  B2  B3  B4  B5  B6  B7  B8  B9  BA  BB  BC  BD  BE       ;
;      C0  C1  C2  C3  C4  C5  C6  C7  C8  C9  CA  CB  CC  CD  CE       ;
;      D0  D1  D2  D3  D4  D5  D6  D7  D8  D9  DA  DB  DC  DD  DE       ;
;      E0  E1  E2  E3  E4  E5  E6  E7  E8  E9  EA  EB  EC  ED  EE       ;
;                                                                       ;
;            EMPTY = 0; BLACK = 1; WHITE = 2; MARKER = 4;               ;
;-----------------------------------------------------------------------;

;-----------------------------------------------------------------------;
;                                VARIABLES                              ;
;-----------------------------------------------------------------------;
; BOARD    $0000-$00EE                                                  ;
; STONES   $0272-$0274                                                  ;
;-----------------------------------------------------------------------;

;-----------------------------------------------------------------------;
;                               PRINT BOARD                             ;
;-----------------------------------------------------------------------;
  PBOARD:  0200  20 2F 1E  JSR $1E2F               ;                    ;
           0203  A2 00     LDX #$00                ;                    ;
  BCLOOP:  0205  8A        TXA                     ;                    ;
           0206  E0 0A     CPX #$0A                ;                    ;
           0208  B0 0F     BCS ADDDGT              ;                    ;
           020A  90 12     BCC ADDCHR              ;                    ;
  PRNCOL:  020C  20 A0 1E  JSR $1EA0               ;                    ;
           020F  20 9E 1E  JSR $1E9E               ;    Print column    ;
           0212  E8        INX                     ;                    ;
           0213  E0 10     CPX #$10                ;                    ;
           0215  D0 EE     BNE BCLOOP              ;                    ;
           0217  F0 0A     BEQ PRNPOS              ;                    ;
  ADDDGT:  0219  69 36     ADD #$36                ;                    ;
           021B  4C 0C 02  JMP PRNCOL              ;                    ;
  ADDCHR:  021E  69 30     ADD #$30                ;                    ;
           0220  4C 0C 02  JMP PRNCOL              ;                    ;
;-----------------------------------------------------------------------;
  PRNPOS:  0223  20 2F 1E  JSR $1E2F               ;                    ;
           0226  A9 31     LDA #$31                ;                    ;
           0228  20 A0 1E  JSR $1EA0               ;                    ;
           022B  20 9E 1E  JSR $1E9E               ;                    ;
           022E  A2 00     LDA #$00                ;                    ;
  PSLOOP:  0230  8A        TXA                     ;                    ;
           0231  C9 EF     CMP #$EF                ;                    ;
           0233  B0 12     BCS SKIPSQ              ;                    ;
           0235  29 0F     AND #$0F                ;                    ;
           0237  C9 0F     CMP #$0F                ;   Print position   ;
           0239  F0 11     BEQ NEWLIN              ;                    ;
           023B  B5 00     LDA BOARD,X             ;                    ;
           023D  A8        TAY                     ;                    ;
           023E  B9 72 02  LDA STONES,Y            ;                    ;
           0241  20 A0 1E  JSR $1EA0               ;                    ;
           0244  20 9E 1E  JSR $1E9E               ;                    ;
  SKIPSQ:  0247  E8        INX                     ;                    ;
           0248  D0 E6     BNE PSLOOP              ;                    ;
           024A  F0 29     BEQ RETPRN              ;                    ;
  NEWLIN:  024C  8A        TXA                     ;--------------------;
           024D  48        PHA                     ;                    ;
           024E  20 2F 1E  JSR $1E2F               ;   Print new line   ;
           0251  68        PLA                     ;                    ;
           0252  AA        TAX                     ;--------------------;
           0253  29 F0     AND #$F0                ;                    ;
           0255  4A        LSR                     ;                    ;
           0256  4A        LSR                     ;                    ;
           0257  4A        LSR                     ;                    ;
           0258  4A        LSR                     ;                    ;
           0259  C9 08     CMP #$08                ;                    ;
           025B  B0 02     BCS ADDDGT              ;                    ;
           025D  90 05     BCC ADDCHR              ;                    ;
  ADDDGT:  025F  69 38     ADD #$38                ;     Print row      ;
           0261  4C 69 02  JMP PRNROW              ;                    ;
  ADDCHR:  0264  69 32     ADD #$32                ;                    ;
           0266  4C 69 02  JMP PRNROW              ;                    ;
  PRNROW:  0269  20 A0 1E  JSR $1EA0               ;                    ;
           026C  20 9E 1E  JSR $1E9E               ;                    ;
           026F  4C 47 02  JMP SKIPSQ              ;                    ;
  STONES:  0272  2E 58 4F  .BYTE '.', '#', 'O'     ;                    ;
  RETPRN:  0275  60        RTS                     ;                    ;
;-----------------------------------------------------------------------;
